<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>BomberZueira Arena PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:#0f0f0f;color:#fff;font-family:Arial;text-align:center}
input,button{padding:10px;margin:5px;font-size:16px}
canvas{background:#1b1b1b;border:2px solid #444;display:none;margin:20px auto}
#hud,#controls,#gameArea{display:none}
.ctrl{padding:12px;font-size:18px;margin:4px}
</style>
</head>
<body>

<h1>üî• BomberZueira Arena üî•</h1>

<div id="login">
<h3>Login / Registro</h3>
<input type="email" id="email" placeholder="Email v√°lido"><br>
<input type="password" id="pass" placeholder="Senha"><br>
<button onclick="register()">Registrar</button>
<button onclick="login()">Entrar</button><br>
<button onclick="connectWallet()">üîó Conectar Carteira</button>
<p id="msg"></p>
</div>

<div id="gameArea">
<div id="hud">
‚ù§Ô∏è Vida: <span id="vida">100</span> |
‚≠ê Pontos: <span id="score">0</span>
</div>

<canvas id="game" width="480" height="480"></canvas>

<div id="controls">
<div><button class="ctrl" onclick="move('up')">‚¨ÜÔ∏è</button></div>
<div>
<button class="ctrl" onclick="move('left')">‚¨ÖÔ∏è</button>
<button class="ctrl" onclick="attack()">üí£</button>
<button class="ctrl" onclick="move('right')">‚û°Ô∏è</button>
</div>
<div><button class="ctrl" onclick="move('down')">‚¨áÔ∏è</button></div>
</div>
</div>

<script>
function validEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function register(){
  const email=document.getElementById("email").value;
  const pass=document.getElementById("pass").value;
  if(!validEmail(email)) return msg("Email inv√°lido");
  if(pass.length<4) return msg("Senha m√≠nima 4");
  localStorage.setItem("user",JSON.stringify({email,pass}));
  msg("Registrado!");
}

function login(){
  const email=document.getElementById("email").value;
  const pass=document.getElementById("pass").value;
  const user=JSON.parse(localStorage.getItem("user")||"{}");
  if(email===user.email && pass===user.pass){
    startGame();
  }else{
    msg("Login incorreto");
  }
}

function connectWallet(){
  alert("Carteira conectada (placeholder)");
}

function msg(t){ document.getElementById("msg").innerText=t; }

const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let player={x:60,y:60,size:28,life:100};
let enemy={x:360,y:360,size:28,life:100};
let bombs=[];
let score=0;
let running=false;

function startGame(){
  document.getElementById("login").style.display="none";
  document.getElementById("gameArea").style.display="block";
  document.getElementById("hud").style.display="block";
  document.getElementById("controls").style.display="block";
  canvas.style.display="block";
  running=true;
  loop();
}

function move(dir){
  if(!running)return;
  if(dir==="up")player.y-=10;
  if(dir==="down")player.y+=10;
  if(dir==="left")player.x-=10;
  if(dir==="right")player.x+=10;
}

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp")move("up");
  if(e.key==="ArrowDown")move("down");
  if(e.key==="ArrowLeft")move("left");
  if(e.key==="ArrowRight")move("right");
  if(e.key===" ")attack();
});

function attack(){ bombs.push({x:player.x,y:player.y,timer:40}); }

function enemyAI(){
  if(enemy.x<player.x)enemy.x+=1;
  if(enemy.x>player.x)enemy.x-=1;
  if(enemy.y<player.y)enemy.y+=1;
  if(enemy.y>player.y)enemy.y-=1;
  let dist=Math.hypot(player.x-enemy.x,player.y-enemy.y);
  if(dist<30)player.life-=0.3;
}

function updateBombs(){
  bombs.forEach(b=>b.timer--);
  bombs.forEach(b=>{
    if(b.timer===0){
      let dist=Math.hypot(enemy.x-b.x,enemy.y-b.y);
      if(dist<60){
        enemy.life-=40;
        score+=20;
      }
    }
  });
  bombs=bombs.filter(b=>b.timer>0);
}

function drawBombs(){
  ctx.fillStyle="yellow";
  bombs.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x+14,b.y+14,10,0,Math.PI*2);
    ctx.fill();
  });
}

function loop(){
  if(!running)return;
  ctx.clearRect(0,0,480,480);

  ctx.fillStyle="lime";
  ctx.fillRect(player.x,player.y,player.size,player.size);

  ctx.fillStyle="red";
  ctx.fillRect(enemy.x,enemy.y,enemy.size,enemy.size);

  enemyAI();
  updateBombs();
  drawBombs();

  document.getElementById("vida").innerText=Math.floor(player.life);
  document.getElementById("score").innerText=score;

  if(player.life<=0){
    alert("Fim de jogo! Pontos: "+score);
    running=false;
    location.reload();
  }

  if(enemy.life<=0){
    enemy.life=100;
    enemy.x=Math.random()*400+40;
    enemy.y=Math.random()*400+40;
  }

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
